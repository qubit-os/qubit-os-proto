// QubitOS Backend Service Definition
// Copyright 2026 QubitOS Contributors
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package quantum.backend.v1;

import "quantum/backend/v1/execution.proto";
import "quantum/backend/v1/hardware.proto";

option java_multiple_files = true;
option java_package = "io.qubitos.backend.v1";

// QuantumBackend service provides access to quantum hardware and simulators.
//
// This is the primary interface for executing pulses and querying backend
// capabilities. All pulse execution flows through this service.
//
// Supported backends:
// - qutip_simulator: Local QuTiP-based simulator (always available)
// - iqm_garnet: IQM Garnet quantum processor (requires credentials)
service QuantumBackend {
  // Execute a single pulse on the specified backend.
  //
  // The pulse is validated before execution. If validation fails,
  // returns INVALID_ARGUMENT error.
  //
  // For simulators: returns measurement samples from the final state.
  // For hardware: submits to queue and returns when complete.
  rpc ExecutePulse(ExecutePulseRequest) returns (ExecutePulseResponse);
  
  // Execute multiple pulses in a batch.
  //
  // More efficient than individual calls when running many pulses.
  // Can optionally stop on first error or continue despite failures.
  rpc ExecutePulseBatch(ExecutePulseBatchRequest) returns (ExecutePulseBatchResponse);
  
  // Get detailed information about a backend.
  //
  // Returns capabilities, resource limits, connectivity, and current status.
  rpc GetHardwareInfo(GetHardwareInfoRequest) returns (HardwareInfo);
  
  // Check health of a specific backend or all backends.
  //
  // Use for monitoring and to check availability before submitting jobs.
  rpc Health(HealthRequest) returns (HealthResponse);
  
  // List all available backends.
  rpc ListBackends(ListBackendsRequest) returns (ListBackendsResponse);
}

// ListBackendsRequest requests a list of all available backends.
message ListBackendsRequest {
  // If true, include detailed info for each backend.
  // If false, return names only (faster).
  bool include_details = 1;

  // Reserved for future use.
  reserved 50 to 100;
}

// ListBackendsResponse contains available backends.
message ListBackendsResponse {
  // Backend names.
  repeated string backend_names = 1;

  // Detailed info if requested.
  repeated HardwareInfo backends = 2;

  // Reserved for future use.
  reserved 50 to 100;
}
